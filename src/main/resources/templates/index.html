<html xmlns:th="http://www.thymeleaf.org">
<html>
	<head>
		<meta charset="UTF-8">
		<title>PayMyBuddy - Homepage</title>
	</head>

	<body>
		<span th:text="${firstName} + ' ' + ${lastName} + ' (balance : ' + ${balance} + ' €)'">Hello [firstName] [lastName]</span><br>
		<a href="/bank"> Add your bank account </a><br>
		<a href="/connections"> Add a buddy </a><br>
		<a href="/logout"> Log out </a>	
	
		<div th:if="${hasConnections}">
			<form method="post" th:action="@{/start-transaction}" th:object="${startTransactionDto}">
			<label for="buddyId">Choose a connection :</label>
			<select th:field="*{buddyId}" name="buddyId" id="buddyId">
			    <option value="">Choose a buddy</option>
			    <option th:each="connection : ${connectionsList}" th:value="${connection.id}" th:text="${connection.firstName} + ' ' + ${connection.lastName}">FirstName LastName</option>
			</select>
			
			<label for="amount">Amount to transfer :</label>
            <input th:field="*{amount}"  type="number" id="amount" name="amount" min="0.1" th:max="${balance}" placeholder="1.00" step="0.1">
            <input type="submit" value="Transfer money">
			</form>
		</div>
		
		<!-- Start of transactions div -->
		<div th:if="${hasTransactions}">
			<table>
          		<thead>
	              <tr>
	                <th></th>
	                <th>Description</th>
	                <th>Amount</th>
	                <th>Date</th>
	              </tr>
            	</thead>
            	
            	<tbody>
					<!-- Loop for each transactions   -->
					<tr th:each="t : ${transactions}">
                
		          		<!-- From/To formatting depend on current user logged -->
		                <td th:if="${userId} eq ${t.senderId}" th:text="'To : ' + ${userService.returnNameFromId({t.recipientId})}">To : firstName lastName</td>
		                <td th:if="${userId} neq ${t.senderId}" th:text="'From : ' + ${userService.returnNameFromId({t.senderId})}">From : firstName lastName</td>
	                
	                	<!-- Transaction description -->
	                	<td th:text="${t.description}">Transaction description</td>
	                
	                	<!-- Amount formatting depending on who is the sender  -->
	                	<td th:if="${userId} eq ${t.senderId}" th:text="'-' + ${t.amount} + '€'">-Amount €</td>
	                	<td th:if="${userId} neq ${t.senderId}" th:text="${t.amount} + '€'">Amount €</td>
	                
	                	<!-- Transaction date -->
	                	<td th:text="${t.date}">Date </td>
	                	
              		</tr>
            	</tbody>   
          	</table> <!-- End of connections table -->
          <br><span th:text="'Number of transactions : ' + ${numberOfTransactions}">Number of transactions : numberOfTransactions</span>
        </div> <!-- End of div -->
        
	</body>
</html>